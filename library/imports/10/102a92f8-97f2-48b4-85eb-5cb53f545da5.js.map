{"version":3,"sources":["assets/scripts/Snake/Snake.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport Body from \"./Body\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Snake extends cc.Component {\n\n    @property(cc.Prefab)\n    bodyPrefab: cc.Prefab = null;\n\n    bodies:cc.Node[]=[]\n\n    curDir:cc.Vec3 = new cc.Vec3(1,0,0)\n\n    bodyCount=3\n\n    isEat=false\n\n    start(){\n        cc.game.on(\"move_up\",this.OnChangeSnakeDir,this);\n        cc.game.on(\"move_down\",this.OnChangeSnakeDir,this);\n        cc.game.on(\"move_left\",this.OnChangeSnakeDir,this);\n        cc.game.on(\"move_right\",this.OnChangeSnakeDir,this);\n    }\n\n    initSnake(defaultBodyCount){\n        for (let i = 0; i < defaultBodyCount; i++) {\n            let newBody = cc.instantiate(this.bodyPrefab);\n            cc.find(\"Canvas\").addChild(newBody);\n            newBody.setPosition(-i*newBody.width-newBody.width,0);\n            //this.bodies.push(newBody);\n        }\n        this.bodyCount=this.bodies.length;\n    }\n\n    startMove(){\n        this.schedule(()=>{\n            this.move();\n        },0.5);\n    }\n\n    move(){\n        let vposition=this.node.position;\n        this.node.x+=this.node.width * this.curDir.x;\n        this.node.y+=this.node.height * this.curDir.y;\n\n        if(this.isEat){\n            let newBody = cc.instantiate(this.bodyPrefab);\n            //newBody.parent=this.node;\n            cc.find(\"Canvas\").addChild(newBody);\n            newBody.position=vposition;\n            this.bodies.splice(0,0,newBody);\n            if(this.bodies.length>3){\n                for (let i = 0; i < this.bodies.length; i++) {\n                    this.bodies[i].getComponent(Body).playAnim(i / 10);\n                }\n            }\n            \n            this.isEat=false;\n        }else if(this.bodies.length>0){\n            this.bodies[this.bodies.length - 1].position = vposition;\n            this.bodies.splice(0,0,this.bodies[this.bodies.length - 1]);\n            //this.bodies.splice(this.bodies.length - 1,1,this.bodies[this.bodies.length - 1]);\n            this.bodies.pop();\n            this.bodyCount=this.bodies.length+1;\n        }\n    }\n\n    OnChangeSnakeDir(curDir){\n        if(curDir==\"up\"){\n            if(curDir!=\"down\"){\n                this.curDir = new cc.Vec3(0,1);\n            }\n        }else if(curDir==\"down\"){\n            if(curDir!=\"up\"){\n                this.curDir = new cc.Vec3(0,-1);\n            }\n        }else if(curDir==\"left\"){\n            if(curDir!=\"right\"){\n                this.curDir = new cc.Vec3(-1,0);\n            }\n        }else if(curDir==\"right\"){\n            if(curDir!=\"left\"){\n                this.curDir = new cc.Vec3(1,0);\n            }\n        }\n    }\n\n    onCollisionEnter(other, self) {\n        if(other.tag==1){//食物\n            this.isEat=true;\n            other.node.destroy()\n        }\n    }\n}\n"]}