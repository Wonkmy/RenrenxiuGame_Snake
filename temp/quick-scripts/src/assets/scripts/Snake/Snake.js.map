{"version":3,"sources":["assets\\scripts\\Snake\\Snake.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport Body from \"./Body\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Snake extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    bodyPrefab: cc.Prefab = null;\r\n\r\n    bodies:cc.Node[]=[]\r\n\r\n    curDir:cc.Vec3 = new cc.Vec3(1,0,0)\r\n\r\n    bodyCount=3\r\n\r\n    isEat=false\r\n\r\n    start(){\r\n        cc.game.on(\"move_up\",this.OnChangeSnakeDir,this);\r\n        cc.game.on(\"move_down\",this.OnChangeSnakeDir,this);\r\n        cc.game.on(\"move_left\",this.OnChangeSnakeDir,this);\r\n        cc.game.on(\"move_right\",this.OnChangeSnakeDir,this);\r\n    }\r\n\r\n    initSnake(defaultBodyCount){\r\n        for (let i = 0; i < defaultBodyCount; i++) {\r\n            let newBody = cc.instantiate(this.bodyPrefab);\r\n            cc.find(\"Canvas\").addChild(newBody);\r\n            newBody.setPosition(-i*newBody.width-newBody.width,0);\r\n            //this.bodies.push(newBody);\r\n        }\r\n        this.bodyCount=this.bodies.length;\r\n    }\r\n\r\n    startMove(){\r\n        this.schedule(()=>{\r\n            this.move();\r\n        },0.5);\r\n    }\r\n\r\n    move(){\r\n        let vposition=this.node.position;\r\n        this.node.x+=this.node.width * this.curDir.x;\r\n        this.node.y+=this.node.height * this.curDir.y;\r\n\r\n        if(this.isEat){\r\n            let newBody = cc.instantiate(this.bodyPrefab);\r\n            //newBody.parent=this.node;\r\n            cc.find(\"Canvas\").addChild(newBody);\r\n            newBody.position=vposition;\r\n            this.bodies.splice(0,0,newBody);\r\n            if(this.bodies.length>3){\r\n                for (let i = 0; i < this.bodies.length; i++) {\r\n                    this.bodies[i].getComponent(Body).playAnim(i / 10);\r\n                }\r\n            }\r\n            \r\n            this.isEat=false;\r\n        }else if(this.bodies.length>0){\r\n            this.bodies[this.bodies.length - 1].position = vposition;\r\n            this.bodies.splice(0,0,this.bodies[this.bodies.length - 1]);\r\n            //this.bodies.splice(this.bodies.length - 1,1,this.bodies[this.bodies.length - 1]);\r\n            this.bodies.pop();\r\n            this.bodyCount=this.bodies.length+1;\r\n        }\r\n    }\r\n\r\n    OnChangeSnakeDir(curDir){\r\n        if(curDir==\"up\"){\r\n            if(curDir!=\"down\"){\r\n                this.curDir = new cc.Vec3(0,1);\r\n            }\r\n        }else if(curDir==\"down\"){\r\n            if(curDir!=\"up\"){\r\n                this.curDir = new cc.Vec3(0,-1);\r\n            }\r\n        }else if(curDir==\"left\"){\r\n            if(curDir!=\"right\"){\r\n                this.curDir = new cc.Vec3(-1,0);\r\n            }\r\n        }else if(curDir==\"right\"){\r\n            if(curDir!=\"left\"){\r\n                this.curDir = new cc.Vec3(1,0);\r\n            }\r\n        }\r\n    }\r\n\r\n    onCollisionEnter(other, self) {\r\n        if(other.tag==1){//食物\r\n            this.isEat=true;\r\n            other.node.destroy()\r\n        }\r\n    }\r\n}\r\n"]}